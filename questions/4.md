---
question: Как можно использовать категориальные данные в моделях машинного обучения? В каких случаях какой подход будет предпочтительней?
module: Теория
---

Категориальные признаки нельзя напрямую подать в большинство моделей, их нужно сначала перевести в численное представление. Основные подходы:

- **Порядковое кодирование (Label Encoding):** каждому категориальному значению присваивается числовой код. Применимо, когда категории имеют естественный порядок (например, «низкий», «средний», «высокий»).

- **One-Hot Encoding (бинарное кодирование):** создаются новые бинарные столбцы по числу категорий, где значение 1 отмечает присутствие категории. Предпочтительно для номинальных (неупорядоченных) категорий с относительно небольшим числом уникальных значений. Например, признак «цвет» можно закодировать столбцами "цвет_красный", "цвет_синий", ... Значения не имеют порядка, поэтому one-hot подходит.

- **Целевое кодирование (Target Encoding):** категория заменяется на некоторое числовое значение, вычисленное из обучающих данных (например, среднее значение целевой переменной для каждой категории). Используется осторожно, чтобы не допустить утечку информации. Предпочтительно при очень многих уникальных категориях, когда one-hot создавать слишком громоздко.

- **Hash Encoding (хеширование категорий):** категории пропускаются через хеш-функцию для получения фиксированного числа столбцов. Это уменьшает размерность и избегает взрыва признаков при большом количестве категорий, но может приводить к коллизиям (разным категориям в один код).

- **Специализированные алгоритмы:** Некоторые алгоритмы умеют работать с категориями напрямую. Например, CatBoost назван так, потому что эффективно обрабатывает категориальные признаки внутри себя. В таких случаях можно подавать категориальные поля без ручного кодирования: модель сама преобразует их (обычно внутренне через схему подобную целевому кодированию с контролем).

Выбор подхода зависит от данных: если категорий мало, удобен one-hot (он прост и не вносит предположений). Если категориальных значений очень много, лучше применять методы вроде target encoding или хеширования, чтобы не раздувать пространство признаков. При наличии порядка в значениях используют порядковое числовое кодирование. А если используете модели, умеющие работать с категориями (например CatBoost), можно довериться им.
