---
question: Спектральная кластеризация в scikit-learn. Вы зачем-то решили внимательно посмотреть на граф к-ближайших соседей. И увидели там 0.5. Как так?
module: Практика
---

В спектральной кластеризации часто используют граф k-ближайших соседей для построения матрицы смежности. Если граф строился не как взаимный (mutual), а просто односторонний k-NN, то получается направленный граф: точка A может иметь соседом B, но B может не иметь A в соседях. Для алгоритма кластеризации нужен **неориентированный** граф, поэтому его приводят к симметричному. Один из способов симметризации - **усреднение весов**: если A сосед B, а B не сосед A, то при симметризации в матрице ставят средний вес (0.5) на обоих направлениях. В результате появляются ребра с весом 0.5, указывающие, что связь была односторонней. Именно поэтому в матрице графа вы могли видеть значение 0.5 - это половина единицы, означающая, что связь между двумя точками была только в одном направлении изначально, а при создании симметричного графа ей присвоили полу-вес, чтобы отразить неполную взаимность. (Если бы обе точки были друг другу в k ближайших, вес стал бы 1 с обеих сторон.)
