---
question: Если вы собрались заниматься stacking / blending, то какие модели лучше в этом всём использовать?
module: Теория
---

В стекинге (блендинге) успех во многом зависит от разнообразия и качества базовых моделей и правильно выбранной мета-модели:

- **Разнообразные базовые модели:** стоит включать несколько моделей разных типов, чтобы они дополняли друг друга. Например, в ансамбле могут быть градиентный бустинг деревьев, случайный лес, нейронная сеть, k-ближайших соседей, SVM, логистическая регрессия – то есть комбинация алгоритмов, которые ошибаются по-разному. Главное, чтобы их прогнозы не были полностью коррелированы. Также можно брать одну модель, но с разными гиперпараметрами или обученную на разных признаках – тоже даст разнообразие.

- **Метамодель (второй уровень):** обычно берут простую модель для окончательного объединения предсказаний. Часто это логистическая регрессия (для классификации) или линейная регрессия (для регрессии), иногда более сложный алгоритм типа небольшого дерева решений. Простая метамодель снижает риск переобучиться на выходах базовых моделей и обычно хорошо справляется с объединением. Её задача – научиться, каким моделям доверять больше в каких случаях.

Таким образом, лучше использовать смесь сильных, но разных по природе алгоритмов в качестве первого уровня, а в качестве второго уровня – простой объединяющий алгоритм. Например, в стеке могут одновременно участвовать CatBoost, нейронная сеть и SVM как базовые, а мета-learner соберёт их прогнозы посредством логистической регрессии. Такое сочетание вероятно даст более устойчивый результат, чем любая отдельная модель.
