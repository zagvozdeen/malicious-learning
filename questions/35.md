---
question: Почему IsolationForest такой быстрый (<a href="https://www.lamda.nju.edu.cn/publication/icdm08b.pdf",>подсказка</a>)?
module: Теория
---

Isolation Forest выигрывает в скорости за счёт своей простоты и особенностей реализации:<br><ul><br>  <li><strong>Линейная сложность:</strong> алгоритм по сути работает за O(n) на построение (плюс умноженное на число деревьев), если брать фиксированный размер выборки на одно дерево. Он не считает расстояния между всеми парами точек и не оптимизирует сложную цель – он просто случайно разбивает данные. Каждая точка проходит через несколько случайных разделений (глубина дерева), обычно глубина ограничена логарифмом от числа точек. В итоге затраты ~ O(n log n) или даже O(n) при ограниченной глубине на дерево.</li><br>  <li><strong>Использование подвыборок:</strong> Isolation Forest часто обучают на небольших подвыборках данных (например, по 256 точек на дерево). Это ещё ускоряет работу и не сильно влияет на качество обнаружения выбросов, так как большего количества точек на одно дерево обычно не нужно. Благодаря этому время обучения масштабируется практически линейно с размером данных, с небольшим коэффициентом.</li><br>  <li><strong>Отсутствие дорогостоящих вычислений:</strong> В алгоритме нет вычисления ковариаций, градиентов или сортировки всех точек по каждому признаку при каждом разбиении (как бывает в детерминированных деревьях). Берётся случайный порог – значит, никакой сложной логики или вычисления критериев не выполняется. Это минимизирует накладные расходы.</li><br>  <li><strong>Параллелизм:</strong> Поскольку каждое дерево строится независимо, их можно строить одновременно на нескольких ядрах процессора. Это позволяет ещё быстрее обучать лес на больших данных, распределяя нагрузку.</li><br></ul><br>Таким образом, IsolationForest – алгоритм с очень низкими затратами на каждое разбиение (они случайны и просты) и с возможностью обрабатывать только часть данных на дерево. Поэтому он масштабируется на большие выборки гораздо лучше, чем методы, требующие глобальных вычислений вроде плотностей или расстояний между каждой парой точек.
