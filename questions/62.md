---
question: Как в scikit-learn получить метрики классификации при кросс-валидации в случае многоклассовой классификации (чтобы не было Nan)?
module: Практика
---

Нужно явно указать способ усреднения метрики для мультикласса. Дело в том, что некоторые метрики (Precision, Recall, F1) по умолчанию рассчитаны на бинарный случай и могут вернуть NaN, если применять их напрямую на многоклассовые данные без указания, как усреднять. Решение - использовать параметр **scoring** в функциях кросс-валидации. Например, вместо scoring='f1' (по умолчанию ожидает бинарного) указать 'f1_macro' или 'f1_weighted' - тогда для каждого фолда будет рассчитано F1 для всех классов с заданным усреднением. То же касается Precision/Recall - есть варианты 'precision_macro', 'recall_micro' и т.д. Эти усреднения избавят от NaN. Ещё вариант - воспользоваться функцией **cross_validate**, в которой можно задать список метрик (например, scoring=\['precision_macro', 'recall_macro'\]), и она вернёт значение каждой метрики для каждого фолда. Главное - указать метод вычисления метрики, который подходит для многоклассового случая. Тогда никакого NaN не будет, и вы получите осмысленные средние метрики по классам.
