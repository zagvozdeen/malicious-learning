---
name: Задача на простой SELECT с группировкой
module: Скрининг
tags:
  - грейды
  - озон
---
Дана таблица "orders":

|  id | user_id |          created_at | price_total |
| --: | ------: | ------------------: | ----------: |
|   1 |     111 | 2024-01-01 10:00:00 |        2000 |
|   2 |     222 | 2024-01-02 10:00:00 |         100 |
|   3 |     111 | 2024-04-01 10:00:00 |      20 000 |
|   4 |     222 | 2024-05-01 10:00:00 |        5000 |
|   5 |     333 | 2024-05-02 10:00:00 |       10000 |
Напишите SQL-запрос, который вернёт количество заказов по каждому пользователю с price_total больше или равным 1000 в таком виде отсортированному по количеству заказов в обратном порядке:

| user_id | order_count |
| ------: | ----------: |
|     111 |           2 |
|     222 |           1 |
|     333 |           1 |
```sql
SELECT user_id, COUNT(*) AS count_count FROM orders WHERE price_total >= 1000 GROUP BY id ORDER BY count_count DESC
```

Если с группировкой не может, то предложить просто выбрать заказы с `price_total >= 1000` (чтобы убедиться что вообще понимает что такое SQL).