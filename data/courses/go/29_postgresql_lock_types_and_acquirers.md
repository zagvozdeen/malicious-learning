---
name: Какие типы блокировок есть в PostgreSQL? Кто берет эти локи?
module: Базы данных
tags:
  - грейды
  - озон
---
Лок на таблицу, лок на запись, пользовательские (рекомендательные) локи.
Далее важно, чтобы человек порассуждал на тему что это за локи, как они конфликтуют между собой.
Локи на таблицу могут брать стандартные команды SQL (Update, Delete, Select, Alter
table...) Например:SELECT берет лок на таблицу типа ACCESS SHARE, который конфликтует,
например, с самым строгим ACCESS EXCLUSIVE.
Локи на строчки в таблице берут стандартные команды SQL, которые меняют данные у
каких-либо записей. Например, есть тип блокировки FOR UPDATE, который конфликтует
сам с собой. Эти же типы локов можно указывать у оператора SELECT. Пример: `Select *
from t1 for update nowait (skip locked)`.
Пользовательские локи можно брать, например, когда нужен общий ресурс для
нескольких приложений и нет возможности шарить его в другой инфре.
