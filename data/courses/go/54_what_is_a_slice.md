---
name: Что такое слайс? Как он устроен?
module: Теория
tags:
  - грейды
---
**17 грейд**

Это абстракция, построенная на основе массива. Обобщенно, слайс это тип данных, построенный как обертка над массивом, представляющая собой часть массива от 0 до N элемента.

От массива слайс отличает следующее:

1. это не массив, но структура, содержащая ссылку на часть массива;
2. может менять свой размер и динамически выделять память;

Внутри слайс представляет собой структуру вида:

```go
package main

import "unsafe"

type slice struct {
	array unsafe.Pointer
	len   int
	cap   int
}
```

Где:

- len (length, длина) — текущая длина слайса
- cap (capacity, вместимость) — длина внутреннего массива: размер массива под который выделена память
- array - собственно ссылка на массив с данными

**18 грейд**

Знает, особенности создания слайсы при использовании двух аргументов make.
Может рассказать о росте памяти при append.

**Дополнительные вопросы**

Q: На что влияет параметр вместимости слайса cap(acity)?\
A: Cap — ключевой параметр для выделения памяти, влияет на производительность вставки в слайс: в случае, если вместимость на момент определения была задана недостаточной, вставка в слайс приведет к частому выделению памяти по мере добавления новых элементов. В идеале, capacity слайса в момент создания должна быть указана максимально близкой к плановому количеству элементов.

Q: Какие способы безопасного копирования слайсов вы знаете?\
A: 1 Через функцию copy() 2) присвоить возвращаемое append() значение слайса новой переменной в случае добавления элемента при len == cap

Q: Как происходит выделение памяти при росте слайса через append? К каким негативным последствиям может неправильное понимание будущего размера слайса в момент его создания?\
A: При размере слайса менее 1024 элементов размер памяти увеличивается вдвое. При размере среза > 1024 элементов, срез увеличивается на четверть текущего размера. Операция вставки в слайс имеет серьезные последствия для памяти - при увеличении capacity массив будет скопирован в новый и размер выделенной памяти будет расти по своей внутренней логике, лишь отчасти связанной с требуемой емкостью.

Q: Когда сборщик мусора удалит массив под слайсом?\
A: Массив будет удален только после того, как не остается ни одного слайса, который ссылается на элементы этого массива.

Q: Какие особенности получения нового среза от ранее существующего слайса вы знаете?\
A: Слайсниг не производит копирование данных слайса. Создаётся новое значение слайса, указывающее на исходный массив.

Q: Чем опасно создание через make слайса с явно указанными len & cap?\
A: При создании слайса с указаной длиной и емкостью будет выделена память под емкость и при этом инициализированы значениями по умолчанию (для типа элементов слайса) len элементов массива. В дальнейшем они будут участвовать в итерировании и являться реальными значениями массива, которые могут внести искажение в данные.
